# !/bin/sh

# test file for P+1 method
#
# Copyright 2002, 2003 Paul Zimmermann and Alexander Kruppa.
#
# This program is free software; you can redistribute it and/or modify it
# under the terms of the GNU General Public License as published by the
# Free Software Foundation; either version 2 of the License, or (at your
# option) any later version.
#
# This program is distributed in the hope that it will be useful, but WITHOUT
# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for
# more details.
#
# You should have received a copy of the GNU General Public License along
# with this program; see the file COPYING.  If not, write to the Free
# Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
# 02111-1307, USA.

export ECM="$1 -pp1"
echo "$ECM" = $ECM
# P+1 requires that sigma^2-4 is a quadratic non-residue mod p

echo 328006342451 | $ECM -x0 5 240 7043
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

# check rational seed
echo 328006342451 | $ECM -x0 1/5 240 7043
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

echo 6215074747201 | $ECM -x0 5 1260 199729
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

echo 8857714771093 | $ECM -x0 3 23251 49207
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

echo 236344687097 | $ECM -x0 3 660 55001
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

echo 87251820842149 | $ECM -x0 5 3691 170249
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

echo 719571227339189 | $ECM -x0 4 41039 57679
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

echo 5468575720021 | $ECM -x0 6 1439 175759
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

echo 49804972211 | $ECM -x0 5 15443 268757
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

echo 329573417220613 | $ECM -x0 3 5279 101573
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

echo 4866979762781 | $ECM -x0 4 7309 97609
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

echo 187333846633 | $ECM -x0 3 2063 9851
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

echo 332526664667473 | $ECM -x0 3 65993 111919
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

echo 265043186297 | $ECM -x0 3 8761 152791
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

echo 207734163253 | $ECM -x0 3 1877 4211
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

echo 225974065503889 | $ECM -x0 5 7867 8243
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

echo 660198074631409 | $ECM -x0 5 22541 115679
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

echo 563215815517 | $ECM -x0 3 3469 109849
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

# test B2min-B2
echo 563215815517 | $ECM -x0 3 3469 109849-109849
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

#echo 409100738617 | $ECM -x0 3 19 19
echo 409100738617 | $ECM -x0 3 24 24
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

# p37 from 45^123+1 found by Peter Montgomery with B1=30M
echo 4190453151940208656715582382315221647 | $ECM -x0 3 2337233 132554351
if $?
then
   echo "############### ERROR ###############";
   exit 1;
fi

echo "All tests are ok."
