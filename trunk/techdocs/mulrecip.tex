\documentclass{article}
\usepackage{amsmath,amssymb}
\begin{document}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Zn}[1]{(\Z/{#1}\Z)^{*}}
\newcommand{\tf}{\tilde{f}}
\newcommand{\tg}{\tilde{g}}
\newcommand{\rev}{\textrm{rev}}

\title{Multiplication of reciprocal Laurent polynomials with a discrete 
       weighted transform}
\author{A. Kruppa}
\maketitle

\begin{abstract}
This note attempts to develop a method for multiplying two reciprocal
Laurent polynomials of degrees $\leq n - 2$ with a weighted DFT of 
length $n$.
\end{abstract}

\section{Without DWT}

Let $f(x)$ be a reciprocal Laurent polynomial
\begin{displaymath}
f(x) = f_0 + \sum_{i=1}^{d_f} f_i (x^i + x^{-i})
\end{displaymath}
of degree $2d_f$ and $\tf(x) = \tf_0 + \sum_{i=1}^{d_f} \tf_i x^i$ with
$\tf_0 = f_0 / 2, \tf_i = f_i \textrm{ for } i>0$ a polynomial so that
$f(x) = \tf(x) + \tf(1/x)$. Likewise for $g(x)$ and $\tg(x)$.
Let $\rev(\tf(x)) = x^{d_f} \tf(1/x)$ denote the polynomial with 
reversed sequence of coefficients. We have $\rev(\rev(\tf(x))) = \tf(x)$ and
$\rev(\tf(x) \tg(x)) = \rev(\tf(x)) \rev(\tg(x))$.
Let $\lfloor f(x) \rfloor$ denote a 
polynomial whose coefficients at non-negative exponents of $x$ are equal to 
those in $f(x)$, and the coefficients at negative exponents of $x$ are 
set to $0$. We have 
$\lfloor f(x) + g(x) \rfloor = \lfloor f(x) \rfloor + \lfloor g(x) \rfloor$.

Now we can compute the prouct
\begin{eqnarray*}
   &   & f(x)g(x) \\
   & = & (\tf(x) + \tf(1/x)) (\tg(x) + \tg(1/x)) \\
   & = & \tf(x) \tg(x) + \tf(x) \tg(1/x) + \tf(1/x)\tg(x) + \tf(1/x)\tg(1/x) \\
   & = & \tf(x) \tg(x) + x^{-d_g} \tf(x) \rev(\tg(x)) + x^{-d_f} \rev(\tf(x))\tg(x) + \tf(1/x)\tg(1/x) \\
   & = & \tf(x) \tg(x) + x^{-d_g} \tf(x) \rev(\tg(x)) + x^{-d_f} \rev(\tf(x) \rev(\tg(x))) + \tf(1/x)\tg(1/x)
\end{eqnarray*}
but we only want to store the coefficients at non-negative exponents in the 
product, so
\begin{eqnarray*}
   &   & \lfloor f(x)g(x) \rfloor \\
   & = & \tf(x) \tg(x) + \lfloor x^{-d_g} \tf(x) \rev(\tg(x)) \rfloor + \lfloor x^{-d_f} \rev(\tf(x) \rev(\tg(x))) \rfloor + \tf_0 \tg_0.
\end{eqnarray*}


\section{With DWT}
Let $f(x) = f_0 + \sum_{i=1}^{n/2-1} f_i (x^i + x^{-i})$ and likewise 
$g(x)$ be reciprocal Laurent polynomials of degrees each at most $n-2$, 
$n$ even.
Their product $h(x) = f(x) \cdot g(x)$ is a reciprocal Laurent polynomial 
of degree at most $2n-4$, 
$h(x) = h_0 + \sum_{i=1}^{n-2} h_i (x^i + x^{-i})$. We aim to find the
$n-1$ coefficients in standard basis of $h(x)$ with a convolution product
of length $n$.

Suppose we compute $\tilde{h}(x) = f(x) \cdot g(x) \bmod (x^n - 1/a)$, then
\begin{eqnarray*}
  \tilde{h}(x) & = & h_0 + \sum_{i=1}^{n-2} h_i (x^i + ax^{n-i}) \\
               & = & h_0 + \sum_{i=1}^{n-2} h_i x^i + \sum_{i=1}^{n-2} ah_i x^{n-i} \\
               & = & h_0 + \sum_{i=1}^{n-2} h_i x^i + \sum_{i=2}^{n-1} ah_{n-i} x^i \\
               & = & h_0 + h_1 x + \sum_{i=2}^{n-2} (h_i + ah_{n-i}) x^i + ah_1 x^{n-1}
\end{eqnarray*}

For $2 \leq i < n/2$, d $\tilde{h}_i = h_i + ah_{n-i}$ and 
$\tilde{h}_{n-i} = ah_i + h_{n-i}$. With $a=1$ as in an unweighted DFT,
$h_i$ and $h_{n-i}$ cannot be separated as $\tilde{h}_i = \tilde{h}_{n-i}$. 
With $a=-1$, they cannot be separated either, as 
$\tilde{h}_i = - \tilde{h}_{n-i}$. 
With, e.g., $a=\sqrt{-1}$, we have
\begin{eqnarray*}
 &   & a (h_i + ah_{n-i}) - (ah_i + h_{n-i}) \\
 & = & (a^2-1) h_{n-i} \\
 & = & -2 h_{n-i}
\end{eqnarray*}
so we can separate $h_i$ and $h_{n-i}$.



\end{document}
